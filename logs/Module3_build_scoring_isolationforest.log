C:\Users\KillDeath\PycharmProjects\PythonProject1\.venv1\Scripts\python.exe C:\Users\KillDeath\PycharmProjects\PythonProject1\Transactions_scoring\Module3_build_scoring_isolationforest.py 
âœ… Loading dataset: check_files/transactions_dataset_final_cleaned.csv.gz
ðŸ”¹ Shape: (737557, 23)
ðŸ”¹ Columns: ['ID', 'SUMPAY', 'SUMPAY_RAW', 'EMP_transaction_count_month', 'EMP_avg_SUMPAY_month', 'EMP_transaction_count_dayweek', 'EMP_avg_SUMPAY_dayweek', 'EMP_ORGINN_count_month', 'EMP_ORGINN_count_dayweek', 'REASONID_transaction_count_month', 'REASONID_avg_SUMPAY_month', 'ORGINN_transaction_count_month', 'ORGINN_avg_SUMPAY_month', 'FILINPUT_transaction_count_month', 'FILINPUT_avg_SUMPAY_month', 'EXP_TYPE_transaction_count_month', 'EXP_TYPE_avg_SUMPAY_month', 'PUPROSE_CODE_transaction_count_month', 'PUPROSE_CODE_avg_SUMPAY_month', 'DUPLICATE_COUNT_EMP_month', 'DUPLICATE_COUNT_ORGINN_month', 'LATE_COUNT_EMP_month', 'LATE_COUNT_ORGINN_month']
         ID     SUMPAY  SUMPAY_RAW  EMP_transaction_count_month  EMP_avg_SUMPAY_month  EMP_transaction_count_dayweek  EMP_avg_SUMPAY_dayweek  EMP_ORGINN_count_month  EMP_ORGINN_count_dayweek  REASONID_transaction_count_month  REASONID_avg_SUMPAY_month  ORGINN_transaction_count_month  ORGINN_avg_SUMPAY_month  FILINPUT_transaction_count_month  FILINPUT_avg_SUMPAY_month  EXP_TYPE_transaction_count_month  EXP_TYPE_avg_SUMPAY_month  PUPROSE_CODE_transaction_count_month  PUPROSE_CODE_avg_SUMPAY_month  DUPLICATE_COUNT_EMP_month  DUPLICATE_COUNT_ORGINN_month  LATE_COUNT_EMP_month  LATE_COUNT_ORGINN_month
0  10948759  6989857.0   6989857.0                          187          2.390551e+07                            396            2.327816e+07                      11                        26                              9112               3.092533e+07                              11             7.205742e+06                               187               2.390551e+07                             48147               2.798846e+07                                  6157                   2.331989e+07                        0.0                           0.0                   0.0                      0.0
1  10950489  6989857.0   6989857.0                          187          2.390551e+07                             32            4.534550e+07                      11                         5                             13018               2.680125e+07                              11             7.205742e+06                               187               2.390551e+07                             48147               2.798846e+07                                  6157                   2.331989e+07                        0.0                           0.0                   0.0                      0.0
2  10950476  2487258.0   2487258.0                          187          2.390551e+07                             32            4.534550e+07                      11                         5                             13018               2.680125e+07                              11             7.205742e+06                               187               2.390551e+07                             48147               2.798846e+07                                 13097                   3.466024e+07                        0.0                           0.0                   0.0                      0.0
3  10950479   971519.0    971519.0                          187          2.390551e+07                             32            4.534550e+07                      11                         5                             13018               2.680125e+07                              11             7.205742e+06                               187               2.390551e+07                             48147               2.798846e+07                                 13097                   3.466024e+07                        0.0                           0.0                   0.0                      0.0
4  10950484     8164.0      8164.0                          187          2.390551e+07                             32            4.534550e+07                      11                         5                             13018               2.680125e+07                              11             7.205742e+06                               187               2.390551e+07                             48147               2.798846e+07                                  6157                   2.331989e+07                        0.0                           0.0                   0.0                      0.0

ðŸ“Š Descriptive statistics with detailed percentiles:
                                         count             mean                  std          min           1%          10%          25%          50%          75%          90%           95%           99%           99.5%           99.9%                     max
ID                                   737,557.0     13,599,844.0          3,843,028.0 10,940,936.0 10,950,356.6 11,052,621.6 11,220,200.0 11,493,474.0 20,023,930.0 20,173,146.4  20,221,019.2  20,262,012.4    20,267,176.2    20,271,180.3            20,272,920.0
SUMPAY                               737,557.0     29,531,026.5         98,490,584.1          0.0     10,252.4    174,540.0    568,644.0  2,250,000.0 11,700,000.0 57,028,200.0 142,947,175.7 751,522,000.0   751,522,000.0   751,522,000.0           751,522,000.0
SUMPAY_RAW                           737,557.0 14,420,605,234.7 11,491,372,337,380.5          0.0     10,252.4    174,540.0    568,644.0  2,250,000.0 11,700,000.0 57,028,200.0 142,947,175.7 751,522,000.0 1,535,577,707.5 7,253,915,970.0 9,860,082,483,994,512.0
EMP_transaction_count_month          737,557.0            399.8                344.5          1.0         54.0        121.0        179.0        285.0        522.0        820.0       1,049.0       1,537.0         1,874.0         3,088.0                 3,088.0
EMP_avg_SUMPAY_month                 737,557.0     29,531,026.5         26,702,422.4     27,112.0  5,213,359.7  9,813,647.0 14,339,297.7 22,407,539.9 33,800,882.7 55,760,990.1  81,701,966.2 151,850,882.2   178,307,208.6   227,999,107.0           751,522,000.0
EMP_transaction_count_dayweek        737,557.0            748.7                554.8          1.0         29.0        229.0        369.0        581.0      1,012.0      1,598.0       1,853.0       2,678.0         2,718.0         2,881.0                 2,881.0
EMP_avg_SUMPAY_dayweek               737,557.0     29,531,026.5         23,892,114.4      5,000.0  7,215,304.4 12,109,158.0 15,559,900.3 22,477,443.4 33,582,219.3 55,420,275.0  75,597,197.0 125,523,920.7   137,638,303.2   206,389,280.2           700,000,000.0
EMP_ORGINN_count_month               737,557.0             43.6                 94.0          1.0          1.0          3.0          7.0         16.0         44.0         99.0         161.0         410.0           532.0         1,408.0                 1,408.0
EMP_ORGINN_count_dayweek             737,557.0             63.4                 99.3          1.0          1.0          5.0         10.0         25.0         77.0        165.0         254.0         465.0           656.0           889.0                   889.0
REASONID_transaction_count_month     737,557.0          7,438.1              5,302.4         20.0        221.0      1,345.0      2,594.0      5,528.0     13,018.0     14,596.0      15,460.0      16,845.0        16,845.0        16,845.0                16,845.0
REASONID_avg_SUMPAY_month            737,557.0     29,531,026.5          8,369,575.3  1,951,175.4 12,047,613.1 17,282,786.3 23,771,192.6 30,170,212.9 34,316,733.8 38,292,193.3  43,436,043.2  52,874,622.4    53,008,935.6    62,990,050.3           110,112,369.0
ORGINN_transaction_count_month       737,557.0             53.2                122.3          1.0          1.0          4.0          8.0         20.0         52.0        114.0         190.0         598.0         1,067.0         1,408.0                 1,408.0
ORGINN_avg_SUMPAY_month              737,557.0     29,531,026.5         59,067,627.8          0.0    178,085.0  1,118,882.5  3,148,836.6  9,562,960.0 28,850,298.6 75,187,740.3 127,917,086.6 281,416,800.4   386,877,218.0   678,527,513.6           751,522,000.0
FILINPUT_transaction_count_month     737,557.0            743.4                859.8          2.0         73.0        132.0        194.0        330.0      1,054.0      2,028.0       2,613.0       3,744.0         4,768.0         4,768.0                 4,768.0
FILINPUT_avg_SUMPAY_month            737,557.0     29,531,026.5         20,842,578.1  1,092,930.0  5,532,988.4 10,310,822.4 15,485,452.5 24,253,846.7 34,794,828.7 58,421,770.2  79,801,601.1  94,258,862.9   102,357,827.0   119,449,370.1           128,910,684.9
EXP_TYPE_transaction_count_month     737,557.0         61,927.8             12,771.7          1.0        999.0     48,147.0     55,416.0     61,551.0     66,406.0     87,385.0      87,385.0      87,385.0        87,385.0        87,385.0                87,385.0
EXP_TYPE_avg_SUMPAY_month            737,557.0     29,531,026.5          8,899,258.8  3,043,600.0 25,628,329.3 27,600,689.6 27,988,459.6 28,416,457.1 29,541,274.5 31,819,349.4  31,819,349.4  45,978,223.2    88,621,283.3   159,836,744.0           272,844,488.3
PUPROSE_CODE_transaction_count_month 737,557.0         41,899.3             18,417.5          1.0      2,794.0      9,316.0     29,620.0     47,912.0     53,768.0     58,803.0      64,117.0      64,117.0        64,117.0        64,117.0                64,117.0
PUPROSE_CODE_avg_SUMPAY_month        737,557.0     29,531,026.5          8,075,146.7          1.0 15,765,583.3 22,065,551.5 28,041,813.5 29,698,092.9 31,976,880.5 34,523,445.6  34,523,445.6  34,660,241.9    43,849,353.5   194,183,290.8           239,106,244.3
DUPLICATE_COUNT_EMP_month            737,557.0              0.6                  2.2          0.0          0.0          0.0          0.0          0.0          0.0          1.0           4.0          12.0            16.0            21.0                    21.0
DUPLICATE_COUNT_ORGINN_month         737,557.0              0.1                  0.6          0.0          0.0          0.0          0.0          0.0          0.0          0.0           0.0           2.0             4.0            11.0                    11.0
LATE_COUNT_EMP_month                 737,557.0              0.1                  0.8          0.0          0.0          0.0          0.0          0.0          0.0          0.0           0.0           1.0             3.0            13.0                    37.0
LATE_COUNT_ORGINN_month              737,557.0              0.0                  0.7          0.0          0.0          0.0          0.0          0.0          0.0          0.0           0.0           0.0             1.0             2.0                    50.0
âœ… Normalization using RobustScaler completed.
âœ… Normalized dataset saved for manual review.
âœ… Isolation Forest model trained with optimized parameters.

ðŸ“Š Cluster distribution:
   â–¸ Normal (0): 722,807 transactions (98.000%)
   â–¸ Anomaly (1): 14,750 transactions (2.000%)

âœ… Final shape: (737557, 3)
ðŸ”¹ Anomaly proportion in dataset: 0.0200
âœ… Final scoring results saved in check_files/isoforest
âœ… Top-300 anomalies saved for manual review.

Process finished with exit code 0
