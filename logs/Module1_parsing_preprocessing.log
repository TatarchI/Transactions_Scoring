C:\Users\KillDeath\PycharmProjects\PythonProject1\.venv1\Scripts\python.exe C:\Users\KillDeath\PycharmProjects\PythonProject1\Transactions_scoring\Module1_parsing_preprocessing.py 
‚úÖ Step 1: Loading .csv.gz
C:\Users\KillDeath\PycharmProjects\PythonProject1\Transactions_scoring\Module1_parsing_preprocessing.py:31: DtypeWarning: Columns (6) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(input_file, compression='gzip')

üîπ Shape: (738166, 20)

üîπ Column data types:
ID               int64
FILIAL           int64
OPERDAY         object
ACC             object
DOCNUMB          int64
DOCDATE         object
SUMPAY          object
SUMPAYFRM       object
EMP              int64
EMPNAME         object
DATEENTER       object
DATEEXEC        object
REASONID         int64
REASONIDNAME    object
DOCID            int64
ORGNAME         object
ORGINN           int64
EXPENSESUM      object
PURPOSE         object
FILINPUT         int64
dtype: object

üîπ Null values per column:
ID              0
FILIAL          0
OPERDAY         0
ACC             0
DOCNUMB         0
DOCDATE         0
SUMPAY          0
SUMPAYFRM       0
EMP             0
EMPNAME         0
DATEENTER       0
DATEEXEC        0
REASONID        0
REASONIDNAME    0
DOCID           0
ORGNAME         0
ORGINN          0
EXPENSESUM      0
PURPOSE         0
FILINPUT        0
dtype: int64

üîπ First 5 rows for visual inspection:
         ID  FILIAL     OPERDAY                          ACC     DOCNUMB     DOCDATE     SUMPAY     SUMPAYFRM    EMP                        EMPNAME            DATEENTER             DATEEXEC  REASONID         REASONIDNAME      DOCID                   ORGNAME     ORGINN           EXPENSESUM                                            PURPOSE  FILINPUT
0  10948759       0  2024-01-05  100010860032027011205018001  2251900034  2024-01-05  6989857.0  6,989,857.00  37337  Umarov Erkinjon Dilmurod ogli  2024-01-05 19:05:07  2024-01-05 19:05:07      2999       –ë–æ—à–∫–∞ —Å–∞–±–∞–±–ª–∞—Ä  147149164  –û–ª—Ç–∏–Ω–∫—É–ª —Ç—É–º–∞–Ω —Ö–æ–∫–∏–º–ª–∏–≥–∏  200254533  14111100~698985700~  07120~100010860032027011205018001~200254533~–û–ª...       447
1  10950489       0  2024-01-06  100010860032027011205018001  2251900034  2024-01-06  6989857.0  6,989,857.00  37337  Umarov Erkinjon Dilmurod ogli  2024-01-06 10:29:39  2024-01-06 10:29:39      2005  –¢—É–ª–æ–≤ –º–∞–∫—Å–∞–¥–∏ —Ö–∞—Ç–æ.  147314344  –û–ª—Ç–∏–Ω–∫—É–ª —Ç—É–º–∞–Ω —Ö–æ–∫–∏–º–ª–∏–≥–∏  200254533  14111100~698985700~  07120~100010860032027011205018001~200254533~–û–ª...       447
2  10950476       0  2024-01-06  100010860032027011205018001  2251900036  2024-01-06  2487258.0  2,487,258.00  37337  Umarov Erkinjon Dilmurod ogli  2024-01-06 10:28:39  2024-01-06 10:28:39      2005  –¢—É–ª–æ–≤ –º–∞–∫—Å–∞–¥–∏ —Ö–∞—Ç–æ.  147315683  –û–ª—Ç–∏–Ω–∫—É–ª —Ç—É–º–∞–Ω —Ö–æ–∫–∏–º–ª–∏–≥–∏  200254533  24121100~248725800~  08102~2001108600032023212170093~08102~10001086...       447
3  10950479       0  2024-01-06  100010860032027011205018001  2251900037  2024-01-06   971519.0    971,519.00  37337  Umarov Erkinjon Dilmurod ogli  2024-01-06 10:28:58  2024-01-06 10:28:58      2005  –¢—É–ª–æ–≤ –º–∞–∫—Å–∞–¥–∏ —Ö–∞—Ç–æ.  147315703  –û–ª—Ç–∏–Ω–∫—É–ª —Ç—É–º–∞–Ω —Ö–æ–∫–∏–º–ª–∏–≥–∏  200254533   14111100~97151900~  08102~1000218604032023111103093~08102~10001086...       447
4  10950484       0  2024-01-06  100010860032027011205018001  2251900038  2024-01-06     8164.0      8,164.00  37337  Umarov Erkinjon Dilmurod ogli  2024-01-06 10:29:20  2024-01-06 10:29:20      2005  –¢—É–ª–æ–≤ –º–∞–∫—Å–∞–¥–∏ —Ö–∞—Ç–æ.  147315733  –û–ª—Ç–∏–Ω–∫—É–ª —Ç—É–º–∞–Ω —Ö–æ–∫–∏–º–ª–∏–≥–∏  200254533     14111100~816400~  07120~100010860032027011205018001~200254533~–û–ª...       447

‚úÖ Dropped non-informative columns: ['ACC', 'DOCNUMB', 'DOCID', 'EMPNAME', 'REASONIDNAME', 'ORGNAME']

‚úÖ Converting date columns to datetime
‚úÖ Date columns processed and SECONDS_DIFF_DATEEXEC_DATEENTER feature added.

‚úÖ Converting numeric columns to numeric (float) format
‚úÖ Conversion completed.

üîπ Data types after date and numeric conversion:
ID                                          int64
FILIAL                                      int64
OPERDAY                            datetime64[ns]
DOCDATE                            datetime64[ns]
SUMPAY                                     object
SUMPAYFRM                                  object
EMP                                         int64
DATEENTER                          datetime64[ns]
DATEEXEC                           datetime64[ns]
REASONID                                    int64
ORGINN                                      int64
EXPENSESUM                                 object
PURPOSE                                    object
FILINPUT                                    int64
SECONDS_DIFF_DATEEXEC_DATEENTER           float64
dtype: object

üéØ Date and numeric conversions completed successfully.

         ID  FILIAL    OPERDAY    DOCDATE       SUMPAY    SUMPAYFRM    EMP  DATEENTER   DATEEXEC  REASONID     ORGINN             EXPENSESUM                                            PURPOSE  FILINPUT  SECONDS_DIFF_DATEEXEC_DATEENTER
0  10948759       0 2024-01-05 2024-01-05    6989857.0    6989857.0  37337 2024-01-05 2024-01-05      2999  200254533    14111100~698985700~  07120~100010860032027011205018001~200254533~–û–ª...       447                              0.0
1  10950489       0 2024-01-06 2024-01-06    6989857.0    6989857.0  37337 2024-01-06 2024-01-06      2005  200254533    14111100~698985700~  07120~100010860032027011205018001~200254533~–û–ª...       447                              0.0
2  10950476       0 2024-01-06 2024-01-06    2487258.0    2487258.0  37337 2024-01-06 2024-01-06      2005  200254533    24121100~248725800~  08102~2001108600032023212170093~08102~10001086...       447                              0.0
3  10950479       0 2024-01-06 2024-01-06     971519.0     971519.0  37337 2024-01-06 2024-01-06      2005  200254533     14111100~97151900~  08102~1000218604032023111103093~08102~10001086...       447                              0.0
4  10950484       0 2024-01-06 2024-01-06       8164.0       8164.0  37337 2024-01-06 2024-01-06      2005  200254533       14111100~816400~  07120~100010860032027011205018001~200254533~–û–ª...       447                              0.0
5  10950487       0 2024-01-06 2024-01-06      99490.0      99490.0  37337 2024-01-06 2024-01-06      2005  200254533      14111100~9949000~  07120~100010860032027011205018001~200254533~–û–ª...       447                              0.0
6  11022198       0 2024-02-02 2024-02-02  403691760.0  403691760.0  37337 2024-02-02 2024-02-02      2999  200254518  24121100~40369176000~  08102~2001108600032023212170093~10001086003202...       447                              0.0
7  11025270       0 2024-02-02 2024-02-02     173912.0     173912.0  37337 2024-02-02 2024-02-02      2005  200254518     14111100~17391200~  100010860032027091100072029~200254518~–û–ª—Ç–∏–Ω–∫—É–ª...       447                              0.0
8  11025892       0 2024-02-02 2024-02-02     240000.0     240000.0  37337 2024-02-02 2024-02-02      2005  200254518     14111100~24000000~  08102~4014228608032023450916179~10001086003202...       447                              0.0
9  11026389       0 2024-02-02 2024-02-02    1400000.0    1400000.0  37337 2024-02-02 2024-02-02      2005  200254518    14111100~140000000~  100010860032027091100072029~200254518~–û–ª—Ç–∏–Ω–∫—É–ª...       447                              0.0

üîπ Number of rows with non-converted string values in SUMPAY: 4 out of 738166
üîπ Unique string values found in SUMPAY:
['#################']

üîπ Number of rows with non-converted string values in SUMPAYFRM: 4 out of 738166
üîπ Unique string values found in SUMPAYFRM:
['#####################']

‚úÖ Processing EXPENSESUM

‚úÖ Processing PURPOSE

‚úÖ Simplified extraction from EXPENSESUM and PURPOSE completed.

üîπ Data types after EXPENSESUM and PURPOSE extraction:
ID                                          int64
FILIAL                                      int64
OPERDAY                            datetime64[ns]
DOCDATE                            datetime64[ns]
SUMPAY                                     object
SUMPAYFRM                                  object
EMP                                         int64
DATEENTER                          datetime64[ns]
DATEEXEC                           datetime64[ns]
REASONID                                    int64
ORGINN                                      int64
EXPENSESUM                                 object
PURPOSE                                    object
FILINPUT                                    int64
SECONDS_DIFF_DATEEXEC_DATEENTER           float64
EXPENSESUM_TYPE_COUNT                       int64
EXPENSESUM_TOTAL_PARSED                   float64
PURPOSE_CODE_5DIGIT                        object
PURPOSE_ID_25DIGIT                         object
dtype: object
          ID  FILIAL    OPERDAY    DOCDATE       SUMPAY    SUMPAYFRM    EMP  DATEENTER   DATEEXEC  REASONID     ORGINN                                         EXPENSESUM                                            PURPOSE  FILINPUT  SECONDS_DIFF_DATEEXEC_DATEENTER  EXPENSESUM_TYPE_COUNT  EXPENSESUM_TOTAL_PARSED PURPOSE_CODE_5DIGIT         PURPOSE_ID_25DIGIT
0   10948759       0 2024-01-05 2024-01-05    6989857.0    6989857.0  37337 2024-01-05 2024-01-05      2999  200254533                                 14111100~698985700  07120~100010860032027011205018001~200254533~–û–ª...       447                              0.0                      1                6989857.0               07120                         No
1   10950489       0 2024-01-06 2024-01-06    6989857.0    6989857.0  37337 2024-01-06 2024-01-06      2005  200254533                                 14111100~698985700  07120~100010860032027011205018001~200254533~–û–ª...       447                              0.0                      1                6989857.0               07120                         No
2   10950476       0 2024-01-06 2024-01-06    2487258.0    2487258.0  37337 2024-01-06 2024-01-06      2005  200254533                                 24121100~248725800  08102~2001108600032023212170093~08102~10001086...       447                              0.0                      1                2487258.0               08102  2001108600032023212170093
3   10950479       0 2024-01-06 2024-01-06     971519.0     971519.0  37337 2024-01-06 2024-01-06      2005  200254533                                  14111100~97151900  08102~1000218604032023111103093~08102~10001086...       447                              0.0                      1                 971519.0               08102  1000218604032023111103093
4   10950484       0 2024-01-06 2024-01-06       8164.0       8164.0  37337 2024-01-06 2024-01-06      2005  200254533                                    14111100~816400  07120~100010860032027011205018001~200254533~–û–ª...       447                              0.0                      1                   8164.0               07120                         No
5   10950487       0 2024-01-06 2024-01-06      99490.0      99490.0  37337 2024-01-06 2024-01-06      2005  200254533                                   14111100~9949000  07120~100010860032027011205018001~200254533~–û–ª...       447                              0.0                      1                  99490.0               07120                         No
6   11022198       0 2024-02-02 2024-02-02  403691760.0  403691760.0  37337 2024-02-02 2024-02-02      2999  200254518                               24121100~40369176000  08102~2001108600032023212170093~10001086003202...       447                              0.0                      1              403691760.0               08102  2001108600032023212170093
7   11025270       0 2024-02-02 2024-02-02     173912.0     173912.0  37337 2024-02-02 2024-02-02      2005  200254518                                  14111100~17391200  100010860032027091100072029~200254518~–û–ª—Ç–∏–Ω–∫—É–ª...       447                              0.0                      1                 173912.0                  No                         No
8   11025892       0 2024-02-02 2024-02-02     240000.0     240000.0  37337 2024-02-02 2024-02-02      2005  200254518                                  14111100~24000000  08102~4014228608032023450916179~10001086003202...       447                              0.0                      1                 240000.0               08102  4014228608032023450916179
9   11026389       0 2024-02-02 2024-02-02    1400000.0    1400000.0  37337 2024-02-02 2024-02-02      2005  200254518                                 14111100~140000000  100010860032027091100072029~200254518~–û–ª—Ç–∏–Ω–∫—É–ª...       447                              0.0                      1                1400000.0                  No                         No
10  11160472       0 2024-03-15 2024-03-15   24954000.0   24954000.0  37337 2024-03-15 2024-03-15      2019  200254518                                14111100~2495400000  100010860032027091100072029~200254518~–û–ª—Ç–∏–Ω–∫—É–ª...       447                              0.0                      1               24954000.0                  No                         No
11  11205151       0 2024-04-02 2024-04-02  206584480.0  206584480.0  37337 2024-04-02 2024-04-02      2007  200254518             14111100~20623154600~14711120~35293400  07120~1000218604032023111103093~10001086003202...       447                              0.0                      2              206584480.0               07120  1000218604032023111103093
12  11224384       0 2024-04-08 2024-04-08    5173000.0    5173000.0  37337 2024-04-08 2024-04-08      2017  200254518                                 14711150~517300000  100010860032027091100072029~200254518~–û–ª—Ç–∏–Ω–∫—É–ª...       447                              0.0                      1                5173000.0                  No                         No
13  11224382       0 2024-04-08 2024-04-08   19781000.0   19781000.0  37337 2024-04-08 2024-04-08      2017  200254518                                14711150~1978100000  100010860032027091100072029~200254518~–û–ª—Ç–∏–Ω–∫—É–ª...       447                              0.0                      1               19781000.0                  No                         No
14  11224380       0 2024-04-08 2024-04-08   16058000.0   16058000.0  37337 2024-04-08 2024-04-08      2017  200254518                                14711150~1605800000  100010860032027091100072029~200254518~–û–ª—Ç–∏–Ω–∫—É–ª...       447                              0.0                      1               16058000.0                  No                         No
15  11224379       0 2024-04-08 2024-04-08   50761000.0   50761000.0  37337 2024-04-08 2024-04-08      2017  200254518                                14711150~5076100000  100010860032027091100072029~200254518~–û–ª—Ç–∏–Ω–∫—É–ª...       447                              0.0                      1               50761000.0                  No                         No
16  11239317       0 2024-04-16 2024-04-16   28038000.0   28038000.0  37337 2024-04-16 2024-04-16      2019  200254518                                14111100~2803800000  100010860032027091100072029~200254518~–û–ª—Ç–∏–Ω–∫—É–ª...       447                              0.0                      1               28038000.0                  No                         No
17  11239673       0 2024-04-16 2024-04-16   24097125.0   24097125.0  37337 2024-04-16 2024-04-16      2019  200254518                                14111100~2409712500  100010860032027091100072029~200254518~–û–ª—Ç–∏–Ω–∫—É–ª...       447                              0.0                      1               24097125.0                  No                         No
18  11239439       0 2024-04-16 2024-04-16   24097125.0   24097125.0  37337 2024-04-16 2024-04-16      2019  200254518                                14111100~2409712500  100010860032027091100072029~200254518~–û–ª—Ç–∏–Ω–∫—É–ª...       447                              0.0                      1               24097125.0                  No                         No
19  11301210       0 2024-05-06 2024-05-06  718091065.0  718091065.0  37337 2024-05-06 2024-05-06      2005  200254518          14111100~49964113500~14111230~21844993000  100010860032027091100072029~200254518~–û–ª—Ç–∏–Ω–∫—É–ª...       447                              0.0                      2              718091065.0                  No                         No
20  11300564       0 2024-05-06 2024-05-06  435067938.0  435067938.0  37337 2024-05-06 2024-05-06      2010  200254518                               24121100~43506793800  07120~2001108600032023212170093~10001086003202...       447                              0.0                      1              435067938.0               07120  2001108600032023212170093
21  11300412       0 2024-05-06 2024-05-06  435067938.0  435067938.0  37337 2024-05-06 2024-05-06      2010  200254518                               24121100~43506793800  07120~2001108600032023212170093~10001086003202...       447                              0.0                      1              435067938.0               07120  2001108600032023212170093
22  11301207       0 2024-05-06 2024-05-06    9445670.0    9445670.0  37337 2024-05-06 2024-05-06      2005  200254518                                 14711120~944567000  100010860032027091100072029~200254518~–û–ª—Ç–∏–Ω–∫—É–ª...       447                              0.0                      1                9445670.0                  No                         No
23  11301202       0 2024-05-06 2024-05-06     390137.0     390137.0  37337 2024-05-06 2024-05-06      2005  200254518                                  14711120~39013700  100010860032027091100072029~200254518~–û–ª—Ç–∏–Ω–∫—É–ª...       447                              0.0                      1                 390137.0                  No                         No
24  11301204       0 2024-05-06 2024-05-06   84639569.0   84639569.0  37337 2024-05-06 2024-05-06      2005  200254518                                14111100~8463956900  100010860032027091100072029~200254518~–û–ª—Ç–∏–Ω–∫—É–ª...       447                              0.0                      1               84639569.0                  No                         No
25  11482808       0 2024-07-03 2024-07-03  349749067.0  349749067.0  37337 2024-07-02 2024-07-02      2019  200254518                               24121100~34974906700  07120~2001108600032023212170093~10001086003202...       447                              0.0                      1              349749067.0               07120  2001108600032023212170093
26  11482810       0 2024-07-03 2024-07-03  166338883.0  166338883.0  37337 2024-07-02 2024-07-02      2019  200254518  14111100~16562998000~14711120~32834100~1411123...  07120~1000228605032023111109093~10001086003202...       447                              0.0                      3              166338883.0               07120  1000228605032023111109093
27  11482824       0 2024-07-03 2024-07-03     800000.0     800000.0  37337 2024-07-02 2024-07-02      2019  200254518                                  14111100~80000000  100010860032027091100072029~200254518~–û–ª—Ç–∏–Ω–∫—É–ª...       447                              0.0                      1                 800000.0                  No                         No
28  11482830       0 2024-07-03 2024-07-03     800000.0     800000.0  37337 2024-07-02 2024-07-02      2019  200254518                                  14111100~80000000  100010860032027091100072029~200254518~–û–ª—Ç–∏–Ω–∫—É–ª...       447                              0.0                      1                 800000.0                  No                         No
29  11488763       0 2024-07-05 2024-07-04   21545000.0   21545000.0  37337 2024-07-04 2024-07-04      2019  200254518              14711150~2117700000~44731000~36800000  100010860032027091100072029~200254518~–û–ª—Ç–∏–Ω–∫—É–ª...       447                              0.0                      2               21545000.0                  No                         No
30  11519554       0 2024-07-15 2024-07-15    4200000.0    4200000.0  37337 2024-07-15 2024-07-15      2019  200254518                                 14111100~420000000  100010860032027091100072029~200254518~–û–ª—Ç–∏–Ω–∫—É–ª...       447                              0.0                      1                4200000.0                  No                         No
31  11520733       0 2024-07-16 2024-07-16    4200000.0    4200000.0  37337 2024-07-16 2024-07-16      2019  200254518                                 14111100~420000000  100010860032027091100072029~200254518~–û–ª—Ç–∏–Ω–∫—É–ª...       447                              0.0                      1                4200000.0                  No                         No
32  11520758       0 2024-07-16 2024-07-16    4200000.0    4200000.0  37337 2024-07-16 2024-07-16      2019  200254518                                 14111100~420000000  100010860032027091100072029~200254518~–û–ª—Ç–∏–Ω–∫—É–ª...       447                              0.0                      1                4200000.0                  No                         No
33  11520785       0 2024-07-16 2024-07-16    4200000.0    4200000.0  37337 2024-07-16 2024-07-16      2019  200254518                                 14111100~420000000  100010860032027091100072029~200254518~–û–ª—Ç–∏–Ω–∫—É–ª...       447                              0.0                      1                4200000.0                  No                         No
34  11520808       0 2024-07-16 2024-07-16    4200000.0    4200000.0  37337 2024-07-16 2024-07-16      2019  200254518                                 14111100~420000000  100010860032027091100072029~200254518~–û–ª—Ç–∏–Ω–∫—É–ª...       447                              0.0                      1                4200000.0                  No                         No
35  11520690       0 2024-07-16 2024-07-16    4200000.0    4200000.0  37337 2024-07-16 2024-07-16      2019  200254518                                 14111100~420000000  100010860032027091100072029~200254518~–û–ª—Ç–∏–Ω–∫—É–ª...       447                              0.0                      1                4200000.0                  No                         No
36  11520375       0 2024-07-16 2024-07-16    4200000.0    4200000.0  37337 2024-07-16 2024-07-16      2019  200254518                                 14111100~420000000  100010860032027091100072029~200254518~–û–ª—Ç–∏–Ω–∫—É–ª...       447                              0.0                      1                4200000.0                  No                         No
37  11520408       0 2024-07-16 2024-07-16    4200000.0    4200000.0  37337 2024-07-16 2024-07-16      2019  200254518                                 14111100~420000000  100010860032027091100072029~200254518~–û–ª—Ç–∏–Ω–∫—É–ª...       447                              0.0                      1                4200000.0                  No                         No
38  11656120       0 2024-09-04 2024-09-04  207550417.0  207550417.0  37337 2024-08-31 2024-08-31      2019  200254518             14111100~20695410500~14711120~59631200  08102~1000228605032023111109093~10001086003202...       447                              0.0                      2              207550417.0               08102  1000228605032023111109093
39  11656112       0 2024-09-04 2024-09-04    1744122.0    1744122.0  37337 2024-08-31 2024-08-31      2019  200254518                 14111100~173911100~14711120~501100  100010860032027091100072029~200254518~–û–ª—Ç–∏–Ω–∫—É–ª...       447                              0.0                      2                1744122.0                  No                         No
40  11731451       0 2024-10-03 2024-10-03  161762989.0  161762989.0  37337 2024-10-02 2024-10-02      2999  200254518  14111100~16061479400~14711120~27235500~1411123...  07120~1000228605032023111109093~10001086003202...       447                              0.0                      3              161762989.0               07120  1000228605032023111109093
41  10949516       0 2024-01-06 2024-01-06    3200000.0    3200000.0  37337 2024-01-05 2024-01-05      2023  200254518                                 14111100~320000000  07120~100010860032027092100072052~200254518~–û–ª...       447                              0.0                      1                3200000.0               07120                         No
42  10971137       0 2024-01-15 2024-01-15    3475000.0    3475000.0  37337 2024-01-15 2024-01-15      2019  200254518                                 14111100~347500000  100010860032027092100072052~200254518~–û–ª—Ç–∏–Ω–∫—É–ª...       447                              0.0                      1                3475000.0                  No                         No
43  10971136       0 2024-01-15 2024-01-15    7173000.0    7173000.0  37337 2024-01-15 2024-01-15      2019  200254518                                 14111100~717300000  100010860032027092100072052~200254518~–û–ª—Ç–∏–Ω–∫—É–ª...       447                              0.0                      1                7173000.0                  No                         No
44  11003180       0 2024-01-26 2024-01-26  141093000.0  141093000.0  37337 2024-01-26 2024-01-26      2017  200254518                               14711150~14109300000  100010860032027092100072052~200254518~–û–ª—Ç–∏–Ω–∫—É–ª...       447                              0.0                      1              141093000.0                  No                         No
45  11003181       0 2024-01-26 2024-01-26    9280000.0    9280000.0  37337 2024-01-26 2024-01-26      2017  200254518                                 14711150~928000000  100010860032027092100072052~200254518~–û–ª—Ç–∏–Ω–∫—É–ª...       447                              0.0                      1                9280000.0                  No                         No
46  11025313       0 2024-02-02 2024-02-02    1200000.0    1200000.0  37337 2024-02-02 2024-02-02      2005  200254518                                 14111100~120000000  100010860032027092100072052~200254518~–û–ª—Ç–∏–Ω–∫—É–ª...       447                              0.0                      1                1200000.0                  No                         No
47  11025454       0 2024-02-02 2024-02-02    1278000.0    1278000.0  37337 2024-02-02 2024-02-02      2019  200254518                                 14111100~127800000  100010860032027092100072052~200254518~–û–ª—Ç–∏–Ω–∫—É–ª...       447                              0.0                      1                1278000.0                  No                         No
48  11025457       0 2024-02-02 2024-02-02     800000.0     800000.0  37337 2024-02-02 2024-02-02      2019  200254518                                  14111100~80000000  100010860032027092100072052~200254518~–û–ª—Ç–∏–Ω–∫—É–ª...       447                              0.0                      1                 800000.0                  No                         No
49  11027397       0 2024-02-05 2024-02-05     346500.0     346500.0  37337 2024-02-03 2024-02-03      2019  200254518                                  14111100~34650000  100010860032027092100072052~200254518~–û–ª—Ç–∏–Ω–∫—É–ª...       447                              0.0                      1                 346500.0                  No                         No

‚úÖ Check 1: Date matching (OPERDAY vs others)
Matches OPERDAY == DOCDATE: 684125 out of 738166
Matches OPERDAY == DATEENTER: 718191 out of 738166
Matches OPERDAY == DATEEXEC: 718191 out of 738166

‚úÖ Check 2: Amount matching (SUMPAY vs others)
Matches SUMPAY == SUMPAYFRM: 738166 out of 738166
Matches SUMPAY == EXPENSESUM_TOTAL_PARSED: 737251 out of 738166

‚úÖ Check 3: FILIAL vs FILINPUT (only where FILIAL != 0)
Matches FILIAL == FILINPUT: 515203 out of 583782

üîé 3 examples of mismatches OPERDAY vs DOCDATE:
      ID    OPERDAY    DOCDATE
11488763 2024-07-05 2024-07-04
11488762 2024-07-05 2024-07-04
11234807 2024-04-15 2024-04-13

üîé 3 examples of mismatches SUMPAY vs EXPENSESUM_TOTAL_PARSED:
      ID     SUMPAY  EXPENSESUM_TOTAL_PARSED
20164377  4908743.0                 260000.0
20253354 15037200.0                3584503.0
20218223   193234.0                 119820.0

üîé 3 examples of mismatches FILIAL vs FILINPUT (FILIAL != 0):
      ID  FILIAL  FILINPUT
11328118     433       447
11539475     433       447
11628745     433       447

üéØ Column hypothesis validation completed.

‚úÖ Performing intermediate cleanup and consistency checks...

üîπ Unique values in SECONDS_DIFF_DATEEXEC_DATEENTER for review:
[0.]
‚úÖ Column HAS_DUPLICATE_ID created. Total duplicates flagged: 1284

üîπ Total duplicate entries based on ID: 1284
‚úÖ Removed 609 duplicate rows. New dataframe shape: (737557, 20)

üîπ Unique PURPOSE_CODE_5DIGIT values: 18
üîπ Unique PURPOSE_ID_25DIGIT values: 6317
‚úÖ Dropped column PURPOSE_ID_25DIGIT after feature extraction.
‚úÖ Converted PURPOSE_CODE_5DIGIT to numeric for modeling.

‚úÖ Starting prefinal cleanup and new feature generation...
‚úÖ Dropped redundant columns: ['DOCDATE', 'DATEENTER', 'DATEEXEC', 'FILIAL', 'SUMPAYFRM', 'EXPENSESUM_TOTAL_PARSED', 'EXPENSESUM', 'PURPOSE', 'SECONDS_DIFF_DATEEXEC_DATEENTER', 'OPERDAY']

üîπ Sample of 20 random rows after prefinal cleanup:
              ID      SUMPAY    EMP  REASONID     ORGINN  FILINPUT  EXPENSESUM_TYPE_COUNT  PURPOSE_CODE_5DIGIT  HAS_DUPLICATE_ID  DIFF_OPERDAY_DOCDATE  OPERDAY_MONTH  OPERDAY_WEEKDAY
279111  11409062  26120578.0  40498      2999  200779529       540                      1                 8102                 0                     0              6                4
219807  11585579  18480000.0  37895      2005  201432889       468                      1                    0                 0                     0              8                4
15189   11472603   2491305.6  38617      2010  200006358       497                      1                    0                 0                     0              6                5
685555  20123553    375000.0   2134      2005  200384300       648                      1                 8102                 0                     0             11                4
623964  20178981   2500000.0   1838      2017  309216633       466                      1                    0                 0                     0             12                2
230350  11143457  15000012.0   2475      2006  201695103       492                      1                 8102                 0                     0              3                1
141537  11525757    408000.0  40052      2007  306333174       603                      1                    0                 0                     0              7                3
19765   11612134     13825.0  40622      2024  200973422       522                      1                    0                 0                     0              8                5
258520  11694071    750000.0  13845      2013  200103411       520                      1                    0                 0                     0              9                2
228842  11369460   1568000.0  41762      2017  200699160       490                      1                    0                 0                     0              5                5
476960  11543845      4596.0  43598      2010  309217964       561                      1                    0                 0                     0              7                3
281563  11392796    660492.0  41823      2999  200784167       541                      1                    0                 0                     0              5                5
153062  11639612   6250000.0  43414      2008  205745923       607                      1                 8102                 0                     0              8                2
409987  11265543   2000000.0  42090      2013  200256539       433                      1                    0                 0                     0              4                2
123405  11494432   1282000.0  39871      2999  205783742       547                      1                    0                 0                     0              7                1
454766  11129749   1500000.0  39856      2011  206988858       552                      1                 8102                 0                     0              3                3
731692  20063275    436609.0   2000      2013  200340600       479                      1                 7120                 0                     0             10                3
706063  20206024    756340.0  45450      2999  207331449       670                      1                    0                 0                     0             12                6
491690  11639633    300000.0  45550      2005  201249893       577                      1                    0                 0                     0              8                2
487587  11444685    287728.0  43598      2999  202010494       561                      1                    0                 0                     0              6                3

üîπ Data types after cleanup:
ID                         int64
SUMPAY                   float64
EMP                        int64
REASONID                   int64
ORGINN                     int64
FILINPUT                   int64
EXPENSESUM_TYPE_COUNT      int64
PURPOSE_CODE_5DIGIT        int64
HAS_DUPLICATE_ID           int32
DIFF_OPERDAY_DOCDATE       int64
OPERDAY_MONTH              int32
OPERDAY_WEEKDAY            int32
dtype: object

üîπ Dataframe shape after cleanup: (737557, 12)

üîπ Descriptive statistics for numeric and categorical features:
                           count              mean                   std            min            25%            50%            75%                      max
ID                    737,557.00     13,599,844.02          3,843,028.01  10,940,936.00  11,220,200.00  11,493,474.00  20,023,930.00            20,272,920.00
SUMPAY                737,557.00 14,420,605,234.75 11,491,372,337,380.53           0.01     568,644.00   2,250,000.00  11,700,000.00 9,860,082,483,994,512.00
EMP                   737,557.00         29,756.00             15,563.80         695.00      13,360.00      38,617.00      41,775.00                70,400.00
REASONID              737,557.00          2,206.84                393.91       2,001.00       2,005.00       2,013.00       2,024.00                 2,999.00
ORGINN                737,557.00    217,942,511.68         37,718,799.80 200,003,425.00 200,498,238.00 201,360,615.00 206,986,496.00           311,783,800.00
FILINPUT              737,557.00            519.46                128.33           0.00         481.00         535.00         595.00                   682.00
EXPENSESUM_TYPE_COUNT 737,557.00              1.01                  0.13           1.00           1.00           1.00           1.00                    22.00
PURPOSE_CODE_5DIGIT   737,557.00          1,662.30              3,230.50           0.00           0.00           0.00           0.00                29,770.00
HAS_DUPLICATE_ID      737,557.00              0.00                  0.03           0.00           0.00           0.00           0.00                     1.00
DIFF_OPERDAY_DOCDATE  737,557.00              0.13                  1.70          -3.00           0.00           0.00           0.00                   623.00
OPERDAY_MONTH         737,557.00              6.70                  3.49           1.00           4.00           7.00          10.00                    12.00
OPERDAY_WEEKDAY       737,557.00              3.05                  1.47           1.00           2.00           3.00           4.00                     6.00

‚úÖ Pre-cleaned dataset saved to check_files/transactions_dataset_pre_cleaned.csv.gz (gzip).

Process finished with exit code 0
