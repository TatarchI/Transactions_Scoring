C:\Users\KillDeath\PycharmProjects\PythonProject1\.venv1\Scripts\python.exe C:\Users\KillDeath\PycharmProjects\PythonProject1\Transactions_scoring\Module5_build_scoring_multi_criteria.py 
âœ… Loading transaction dataset...
âœ… Loading feature weights...
âœ… Performing robust normalization using robust z-score scaling...
âœ… Calculating weighted multi-criteria scores...

ðŸ“Š Quantile distribution of multi_criteria_score:
0.000              1.8
0.010              4.1
0.100              6.1
0.250              7.9
0.500             10.9
0.750             16.5
0.900             28.4
0.950             45.3
0.970             62.0
0.980             80.3
0.990            106.3
0.995            176.5
1.000    885,793,480.3
Name: multi_criteria_score, dtype: object

ðŸ“Œ Top-20 transactions by score with feature breakdown:
multi_criteria_score   SUMPAY_RAW  EMP_transaction_count_month  EMP_avg_SUMPAY_month  EMP_transaction_count_dayweek  EMP_avg_SUMPAY_dayweek  EMP_ORGINN_count_month  EMP_ORGINN_count_dayweek  REASONID_transaction_count_month  REASONID_avg_SUMPAY_month  ORGINN_transaction_count_month  ORGINN_avg_SUMPAY_month  FILINPUT_transaction_count_month  FILINPUT_avg_SUMPAY_month  EXP_TYPE_transaction_count_month  EXP_TYPE_avg_SUMPAY_month  PUPROSE_CODE_transaction_count_month  PUPROSE_CODE_avg_SUMPAY_month  DUPLICATE_COUNT_EMP_month  DUPLICATE_COUNT_ORGINN_month  LATE_COUNT_EMP_month  LATE_COUNT_ORGINN_month
         885793480.3 8.857935e+08                    -0.536443             -0.330445                      -0.132193               -0.030098                0.054054                  0.328358                          0.375288                   0.060899                       -0.045455                 1.423085                         -0.243023                  -0.498209                         -1.647043                   0.833120                             -0.606013                       0.888540                        0.0                           0.0                   0.0                      0.0
          21659589.0 2.165958e+07                     1.457726              0.143501                       1.978227                0.988574               -0.135135                  0.000000                          0.832886                   0.000000                       -0.181818                 2.226294                          0.565116                   0.280350                          0.441765                   2.191435                              0.412125                       1.226244                        0.0                           0.0                   0.0                      0.0
          21659579.7 2.165957e+07                    -0.131195             -0.553474                       0.012442               -0.573039               -0.324324                 -0.194030                          0.527533                   0.157940                       -0.363636                 7.161754                         -0.104651                  -0.653454                          0.000000                   0.342826                             -0.104398                       0.579098                        0.0                           0.0                   0.0                      0.0
          21659556.0 2.165954e+07                    -0.475219              0.339496                      -0.525661                0.031034               -0.378378                 -0.328358                          0.586915                   0.393201                       -0.409091                14.520498                         -0.240698                   0.235180                          0.000000                   0.342826                             -0.104398                       0.579098                        0.0                           0.0                   0.0                      0.0
            340505.7 3.404794e+05                     0.422741              3.202313                       0.657854                2.132538               -0.081081                 -0.119403                         -0.301516                   0.700468                       -0.159091                15.166992                          0.325581                   1.962329                          0.000000                   0.342826                             -0.104398                       0.579098                        0.0                           0.0                   0.0                      0.0
             47747.2 4.770491e+04                    -0.166181              3.247292                      -0.279938                3.428539               -0.351351                 -0.179104                         -0.253645                  -0.675951                       -0.363636                25.947263                          0.900000                   2.264937                          0.441765                   2.191435                              0.412125                       1.226244                        0.0                           0.0                   0.0                      0.0
             43757.5 4.371958e+04                    -0.413994             10.563968                      -0.472784               11.494485                0.000000                  0.119403                         -0.123657                  -0.004939                       -0.090909                 4.859416                          3.969767                   2.514879                          2.350682                   0.000000                              0.671070                       0.323111                        0.0                           0.0                   0.0                      0.0
             34602.5 3.458678e+04                     0.737609              0.879571                       0.937792                1.012084               -0.027027                  0.298507                         -0.242997                   0.123782                       -0.068182                 5.505725                          1.205814                   2.263102                         -0.021383                  -1.795531                              0.138976                      -0.420902                        0.0                           0.0                   0.0                      0.0
             34284.6 3.427185e+04                     0.489796              0.223865                       0.877138                0.687270                0.675676                  1.164179                         -0.154547                   0.638691                        0.477273                 4.566117                          0.020930                   0.412832                         -0.021383                  -1.795531                              0.138976                      -0.420902                        0.0                           0.0                   0.0                      0.0
             34284.0 3.427185e+04                     0.489796              0.223865                       0.765163                0.843283                0.675676                  0.477612                         -0.154547                   0.638691                        0.477273                 4.566117                          0.020930                   0.412832                         -0.021383                  -1.795531                              0.138976                      -0.420902                        0.0                           0.0                   0.0                      0.0
             34284.0 3.427185e+04                     0.489796              0.223865                       0.765163                0.843283                0.675676                  0.477612                         -0.154547                   0.638691                        0.477273                 4.566117                          0.020930                   0.412832                         -0.021383                  -1.795531                              0.138976                      -0.420902                        0.0                           0.0                   0.0                      0.0
             34283.8 3.427185e+04                     0.489796              0.223865                       0.836703                0.388594                0.675676                  0.686567                         -0.154547                   0.638691                        0.477273                 4.566117                          0.020930                   0.412832                         -0.021383                  -1.795531                              0.138976                      -0.420902                        0.0                           0.0                   0.0                      0.0
             22167.0 2.211391e+04                     1.040816              2.800129                       0.777605                3.378382               -0.378378                 -0.328358                          1.085668                  -0.235307                       -0.409091                28.868359                          3.969767                   2.514879                          2.350682                   0.000000                              0.671070                       0.323111                        4.0                           0.0                   0.0                      0.0
             21307.6 2.127682e+04                     0.311953              0.719383                       0.872473                0.412810               -0.270270                 -0.104478                         -0.332310                   0.390933                       -0.159091                23.068351                          1.022093                   0.253177                         -1.219654                  -0.275627                             -0.757495                      -0.659943                        0.0                           0.0                   0.0                      0.0
             20387.7 2.038347e+04                    -0.163265             -0.489746                      -0.345257               -0.217062                0.000000                 -0.089552                         -0.261896                   0.058984                       -0.045455                 1.463131                          0.447674                  -0.203890                          0.140400                  -0.161880                              0.081994                      -0.064962                        0.0                           0.0                   0.0                      0.0
             19505.6 1.948939e+04                     0.775510              0.086819                       1.049767               -0.459867                0.027027                 -0.208955                         -0.009401                   0.816993                       -0.068182                 8.188738                          0.256977                  -0.008114                          0.441765                   2.191435                              0.412125                       1.226244                        0.0                           0.0                   0.0                      0.0
             19505.6 1.948939e+04                     0.775510              0.086819                       1.049767               -0.459867                0.027027                 -0.208955                         -0.009401                   0.816993                       -0.068182                 8.188738                          0.256977                  -0.008114                          0.441765                   2.191435                              0.412125                       1.226244                        0.0                           0.0                   0.0                      0.0
             15620.0 1.558351e+04                     0.236152             -0.301413                       0.674961               -0.212432               -0.378378                 -0.358209                         -0.395817                  -1.193697                       -0.409091                28.868359                          0.041860                  -0.399406                          0.000000                   0.342826                             -0.104398                       0.579098                        2.0                           0.0                   0.0                      0.0
             15517.2 1.548863e+04                    -0.352770              1.480017                      -0.384137                1.857965               -0.378378                 -0.328358                         -0.255084                   0.545416                       -0.386364                19.123103                          0.505814                   0.365704                          0.537762                  -0.511846                              0.451010                      -0.100682                        0.0                           0.0                   1.0                      0.0
             15516.4 1.548863e+04                    -0.352770              1.480017                      -0.510109                0.901729               -0.378378                 -0.298507                          0.648983                   0.167511                       -0.386364                19.123103                          0.505814                   0.365704                          0.537762                  -0.511846                              0.451010                      -0.100682                        0.0                           0.0                   1.0                      0.0

ðŸ’¾ Saving normalized dataset to disk. This may take 20-30 seconds...

âœ… Normalized dataset saved in check_files/multi_criteria
âœ… Final scoring outputs saved in check_files/multi_criteria
âœ… Top-300 anomalies saved for manual inspection.

âœ… Module completed. Model ready for comparison with IsoForest scoring.

ðŸ“Œ Top-3 anomalies per feature (where contribution exceeds SUMPAY_RAW):
      ID  multi_criteria_score                              feature  feature_value  SUMPAY_RAW_value
20160754                 80.34          EMP_transaction_count_month           8.17              5.05
20229186                117.36          EMP_transaction_count_month           8.17             -0.20
20164726                117.66          EMP_transaction_count_month           8.17             -0.07
20074086                 83.84                 EMP_avg_SUMPAY_month          14.26              1.32
20095516                153.19                 EMP_avg_SUMPAY_month          14.26              8.40
11602373                 86.54                 EMP_avg_SUMPAY_month           6.91              5.42
20170628                 81.17        EMP_transaction_count_dayweek           3.58              2.49
20170631                117.95        EMP_transaction_count_dayweek           3.58             -0.07
11048524                 99.74        EMP_transaction_count_dayweek           3.58             -0.10
11647983                 82.16               EMP_avg_SUMPAY_dayweek           6.39              0.12
11649957                 84.31               EMP_avg_SUMPAY_dayweek           6.39              1.76
11647979                 82.18               EMP_avg_SUMPAY_dayweek           6.39              0.13
20127892                147.16               EMP_ORGINN_count_month          37.62             13.35
20137519                 94.92               EMP_ORGINN_count_month          37.62              0.02
20151705                 93.66               EMP_ORGINN_count_month          37.62              0.02
20137482                 95.08             EMP_ORGINN_count_dayweek          12.90             -0.18
20137555                 95.05             EMP_ORGINN_count_dayweek          12.90             -0.15
20117409                 95.20             EMP_ORGINN_count_dayweek          12.90             -0.17
20251869                 91.04     REASONID_transaction_count_month           1.09             -0.16
20253408                 91.06     REASONID_transaction_count_month           1.09             -0.18
20251836                 90.98     REASONID_transaction_count_month           1.09             -0.11
11024549                147.65            REASONID_avg_SUMPAY_month           4.38              1.07
11024365                105.99            REASONID_avg_SUMPAY_month           4.38              2.34
11024970                147.65            REASONID_avg_SUMPAY_month           4.38              1.07
20127892                147.16       ORGINN_transaction_count_month          31.55             13.35
20147368                 93.88       ORGINN_transaction_count_month          31.55             -0.18
20137465                 95.07       ORGINN_transaction_count_month          31.55             -0.18
20143983                167.46              ORGINN_avg_SUMPAY_month          21.26              7.31
20144271                167.25              ORGINN_avg_SUMPAY_month          21.26              7.30
20136075                 87.12              ORGINN_avg_SUMPAY_month          21.26              9.34
20160754                 80.34     FILINPUT_transaction_count_month           5.16              5.05
20170628                 81.17     FILINPUT_transaction_count_month           5.16              2.49
20176815                116.72     FILINPUT_transaction_count_month           5.16             -0.07
11128992                 97.57            FILINPUT_avg_SUMPAY_month           3.88              0.05
11628912                 85.26            FILINPUT_avg_SUMPAY_month           3.63              3.06
11614115                 81.16            FILINPUT_avg_SUMPAY_month           3.63              0.33
11584965                175.97     EXP_TYPE_transaction_count_month          -5.60              3.64
20257667                137.80     EXP_TYPE_transaction_count_month          -5.60              0.39
20269672                143.74     EXP_TYPE_transaction_count_month          -5.60              1.24
11596260                212.94            EXP_TYPE_avg_SUMPAY_month         157.41             28.48
11598725                213.10            EXP_TYPE_avg_SUMPAY_month         157.41             28.48
11584965                175.97            EXP_TYPE_avg_SUMPAY_month         157.41              3.64
11657019                 84.08 PUPROSE_CODE_transaction_count_month          -1.98              1.95
11302426                 98.82 PUPROSE_CODE_transaction_count_month          -1.98             -0.12
11399163                107.55 PUPROSE_CODE_transaction_count_month          -1.98              0.89
11483966                123.71        PUPROSE_CODE_avg_SUMPAY_month          53.22             50.81
11478848                106.88        PUPROSE_CODE_avg_SUMPAY_month          53.22             40.98
11484046                124.36        PUPROSE_CODE_avg_SUMPAY_month          53.22             50.81
20229186                117.36            DUPLICATE_COUNT_EMP_month          21.00             -0.20
20176546                 87.72            DUPLICATE_COUNT_EMP_month          21.00             11.40
20170628                 81.17            DUPLICATE_COUNT_EMP_month          21.00              2.49
20267223                 90.66         DUPLICATE_COUNT_ORGINN_month          11.00              1.04
20168469                 88.86         DUPLICATE_COUNT_ORGINN_month          11.00             -0.02
20226034                 86.02         DUPLICATE_COUNT_ORGINN_month          11.00             -0.12
20037451                 99.91                 LATE_COUNT_EMP_month          37.00             -0.18
20039345                 99.31                 LATE_COUNT_EMP_month          37.00             -0.18
20039382                 99.31                 LATE_COUNT_EMP_month          37.00             -0.18
20061819                 84.92              LATE_COUNT_ORGINN_month          50.00              3.42
20039345                 99.31              LATE_COUNT_ORGINN_month          50.00             -0.18
20039382                 99.31              LATE_COUNT_ORGINN_month          50.00             -0.18

âœ… Saved to check_files/multi_criteria/top_features_contribution_anomalies.xlsx for review.

Process finished with exit code 0
